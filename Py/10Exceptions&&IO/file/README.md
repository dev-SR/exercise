# File

- [File](#file)
	- [Basic](#basic)
		- [Opening a File](#opening-a-file)
			- [Python File Modes](#python-file-modes)
		- [Closing a File](#closing-a-file)
		- [Context Managers (with)](#context-managers-with)
	- [Writing to a file](#writing-to-a-file)
	- [Reading from a file](#reading-from-a-file)
		- [Read line by line](#read-line-by-line)
				- [using for loop](#using-for-loop)
			- [using `readline()`, `readlines()`](#using-readline-readlines)
		- [The file handle](#the-file-handle)
		- [Read Block by Block](#read-block-by-block)
		- [Find info from File](#find-info-from-file)
	- [Appending to a file](#appending-to-a-file)
	- [Changing the content in a file](#changing-the-content-in-a-file)
	- [Change File Name](#change-file-name)
	- [Examples](#examples)
		- [Rename Files having same name in different directories](#rename-files-having-same-name-in-different-directories)


```python
"""
cd '.\Py\10Exceptions&&IO\file\'
jupyter nbconvert --to markdown py_file.ipynb --output README.md
"""
```

##  Basic



### Opening a File


- Python has a built-in function `open()` to open a file
- This function returns a file object, also called a file handle, as it is used to read or modify the file accordingly


```python
f = open("read.txt")
```

We can specify the mode while opening a file. In mode, we specify whether we want to read `'r'`, write `'w'` or append `'x'` to the file. We also specify if we want to
open the file in text mode or binary mode.

There are 2 types of Files:

- Text Files
- Binary Files


#### Python File Modes



- `'r'` Open a file for reading. (default)
- `'W'` Open a file for writing. Creates a new file if it does not exist or truncates the file if it exists.
- `'a'` Open for appending at the end of the file without truncating it. Creates a new file if it does not exist.
- `'t'` Open in text mode. (default)
- `'b'` Open in binary mode.
- `'+'` Open a file for updating (reading and writing)



```python
f = open("read.txt",'r')
f = open("write.txt",'w')
```

### Closing a File

Closing a file will free up the resources that were tied with the file and is done using the `close()` method.
Python has a garbage collector to clean up unreferenced objects but, we must not rely on it to close the file.


```python
f = open("read.txt")
f.close()
```

### Context Managers (with)

- In Python, de-allocation of resources can be achieved by the usage of context managers which facilitate the
proper handling of resources.
- The most common way of performing file operations is by using the `with` keyword.


```python

with open('read.txt','r') as f:
	print("Inside: ",f.closed) # `False`

print("Outside: ",f.closed) # `True` that means file is already closed

```

    Inside:  False
    Outside:  True


## Writing to a file

- In order to write some content to a file, we need to open file in 'w' or 'a' mode.
- writing a string or sequence of bytes can be done using `write()`
- Returns the number of characters written



```python
with open('write.txt', 'w', encoding='utf-8') as f:
	f.write("This file has been generated by Python.\n")
	r = f.write("I love python\n")
	r1 = f.write("❤❤❤")  # encoding='utf-8'
	print(r,r1)
```

    14 3



```python
out =  open('write.txt', 'w', encoding='utf-8')
s = "This file has been generated by Python.\n"
s1 = "I love python\n"
r1 = "❤❤❤"
print((s+s1+r1),file=out)
out.close()
```

## Reading from a file

- You can read the content from a file using a method called `read()` ,`readline()`, `readlines()`.

sample text:

- This is line 1 sen-1. This is line 1 sen-2.
- This is line 2.
- This is line 3.
- This is line 4.


```python
with open('read.txt', 'r') as f:

	# reads only 5 chars
	data = f.read(5)
	print(data)

	# reads next 10 charaters
	data = f.read(10)
	print(data)

```

    This
    is line 1


> The difference between `file.read()`, `file.readline()`, `file.readlines()`


| method                             | workings                                                                                                                                |
| ---------------------------------- | --------------------------------------------------------------------------------------------------------------------------------------- |
| `single_string = file.read()`      | Reads **all the elements of the file** into a **single** `string`(`\n` characters might be included). EX: `"line 1\n line 2\n line3\n"` |
| `line = file.readline()`           | **Reads the current line** where the cursor as a string is positioned and **moves to the next line**.  EX: `"line 1"`                   |
| ` list_strings = file.readlines()` | **Makes a `list` of strings**. EX: `['line 1\n', 'line 2\n', 'line3\n'`]                                                                |



```python
with open('read.txt', 'r') as f:
	# reads complete data and stores as String
	data= f.read()
	print(type(data))
	print(len(data))
	print(data.strip())

```

    <class 'str'>
    107
    This is line 1 sen-1. This is line 1 sen-2.
    This is line 2.
    This is line 3.
    This is line 4.
    This is line 5.



```python
with open('read.txt', 'r') as f:

	# reads 1 line at a time
	data= f.readline()
	print(type(data))
	print(len(data))
	print(data)

	# reads 2nd lien
	data= f.readline()
	print(data)
```

    <class 'str'>
    44
    This is line 1 sen-1. This is line 1 sen-2.

    This is line 2.




```python
with open('read.txt', 'r') as f:

	# reads complete data and stores in list
	data= f.readlines()
	print(type(data))
	print(data)
	print("Total lines: ",len(data))
```

    <class 'list'>
    ['This is line 1 sen-1. This is line 1 sen-2.\n', 'This is line 2.\n', 'This is line 3.\n', 'This is line 4.\n', 'This is line 5.']
    Total lines:  5



```python
print("Total lines: ",len(open("read.txt").readlines()))
```

    Total lines:  5


### Read line by line

##### using for loop


```python
with open('read.txt', 'r') as f:
	for line in f:
		print(line.strip())
```

    This is line 1 sen-1. This is line 1 sen-2.
    This is line 2.
    This is line 3.
    This is line 4.
    This is line 5.



```python
with open('read.txt', 'r') as f:
	for i, l in enumerate(f):
		print(i, l, end="")
```

    0 This is line 1 sen-1. This is line 1 sen-2.
    1 This is line 2.
    2 This is line 3.
    3 This is line 4.
    4 This is line 5.

#### using `readline()`, `readlines()`


```python
with open('read.txt', 'r') as f:
	line = f.readline()
	print(type(line))

	while line:
		print(line.strip())
		line = f.readline()
```

    <class 'str'>
    This is line 1 sen-1. This is line 1 sen-2.
    This is line 2.
    This is line 3.
    This is line 4.
    This is line 5.



```python
with open('read.txt', 'r') as f:
	data = f.readlines()
	print(type(data))

	for line in data:
		# print(line,end="")
		print(line.strip())

```

    <class 'list'>
    This is line 1 sen-1. This is line 1 sen-2.
    This is line 2.
    This is line 3.
    This is line 4.
    This is line 5.


### The file handle


**File handle** is like a `cursor`, which defines from where the data has to be read or written in the file.

1. `tell()`: **current the position**
2. `f.seek(offset, from_what)`:
   -  **change the position** of the File Handle to a given specific position.
   - `Offset`: Number of positions to move forward
   - `from_what`: It defines point of reference `0,1,2`.
       - `0`: sets the reference point at the `beginning` of the file
       - `1`: sets the reference point at the `current` file position
       - `2`: sets the reference point at the `end` of the file


```python
with open('read.txt', 'r') as f:
	# file handle at beginning
	print("current pos:",f.tell())
	print(f.readline().strip())
	print("current pos:",f.tell())

	# take file handle to the beginning
	f.seek(0)
	print("current pos:",f.tell())
	print(f.readline().strip())
	print("current pos:",f.tell())


```

    current pos: 0
    This is line 1 sen-1. This is line 1 sen-2.
    current pos: 45
    current pos: 0
    This is line 1 sen-1. This is line 1 sen-2.
    current pos: 45



```python
with open('read.txt', 'r') as f:
	print(len(f.read()))
	f.seek(0)
	print("current pos:",f.tell())
	print(f.readline().strip())
	print("current pos:",f.tell())

	f.seek(10)
	print("current pos:",f.tell())
	print(f.readline().strip())
	print("current pos:",f.tell())

	f.seek(0,1)
	print("current pos:",f.tell())
	print(f.readline().strip())
	print("current pos:",f.tell())

	f.seek(0,2)
	print("current pos:",f.tell())
	print(f.readline().strip())
```

    107
    current pos: 0
    This is line 1 sen-1. This is line 1 sen-2.
    current pos: 45
    current pos: 10
    ne 1 sen-1. This is line 1 sen-2.
    current pos: 45
    current pos: 45
    This is line 2.
    current pos: 62
    current pos: 111



### Read Block by Block

TASK:

- Read `read_block` file form `CHAPTER I.` then
- Divide them in `n` No. of `blocks`

Finding starting point `CHAPTER I.`:


```python
with open('read_block.txt', 'r') as f:
	data = f.read()
	data = data.split()
	"""
	splits CHAPTER I. as ["CHAPTER","I."]
	splits CHAPTER II. as ["CHAPTER","I."]
	...
	splits `"Why don't you knock him down?" said I. "That's the only kind of treatment such a man can understand."`
	as ....[ "said","I.","That's.....]
	 """
	for i,d in enumerate(data):
		if "I." in d:
			print(i," ",data[i-1])

```

    316   CHAPTER
    330   CHAPTER
    346   CHAPTER
    460   CHAPTER
    471   CHAPTER
    484   CHAPTER
    578   CHAPTER
    590   CHAPTER
    648   CHAPTER
    1378   said


Which makes it not ideal to look for `I.`

Replacing `"CHAPTER I."` with `"CHAPTERI."`


```python
out = open("read_block.txt","w")
with open('read_block_original.txt', 'r') as f:
	data = f.read()
	if "CHAPTER I." in data:
		data = data.replace("CHAPTER I.","CHAPTERI.")
		print(data,file=out)
out.close()
```


```python
with open('read_block.txt', 'r') as f:
	data = f.read()
	data = data.split()
	if "CHAPTERI." in data:
		print("F")
	# print(data)
```

    F



```python
out = open('read_block_mod.txt', 'w')
with open('read_block.txt', 'r') as f:
	data = f.read()
	# print(len(data.split()))
	total_word = len(data.split())
	data = data.split()
	indices = []
	for i,w in enumerate(data):
		# start reading from CHAPTER I.
		if "CHAPTERI" in w:
			indices.append(i)
	last = indices[-1]
	# print(last)
	data = data[last+1:]

	n=10
	for i in range(n):
		s = round(total_word*i/n)
		e = round(total_word*(1+i)/n)
		# print(s,e)
		chunks = data[s:e]
		chunks = " ".join(chunks)
		print(chunks,file=out)
		print(100*"=",file=out)

out.close()
```

### Find info from File


```python
author_name=""
with open("read_block.txt", 'r') as target_file:
	for num, line in enumerate(target_file.readlines()):
		if str("Author") in line:
			author_name = line.split(":")[1].strip()
author_name
```




    'Robert C. (Chamblet) Adams'



## Appending to a file

- file mode `'a'` can be used to append to the existing file


```python
with open('read.txt', 'r') as f:
	print(f.read())

print()

with open('read.txt', 'a') as f:
	f.write("\nAppending this line at the end")

with open('read.txt', 'r') as f:
	print(f.read())
```

    Hello World
    From file

    Hello World
    From file
    Appending this line at the end


## Changing the content in a file


```python
filename = 'read.txt'
data = None

with open(filename,'r') as f:
	data= f.readlines()

print(data)
```

    ['Hello World\n', 'From file\n', 'Appending this line at the end']



```python
data[-1] = "Python is FUN !!❤❤"
print(data)

```

    ['Hello World\n', 'From file\n', 'Python is FUN !!❤❤']



```python
data_to_write = "".join(data)
data_to_write
```




    'Hello World\nFrom file\nPython is FUN !!❤❤'




```python
with open('temp.txt', 'w', encoding='utf-8') as f:
	f.write(data_to_write)
```

## Change File Name


```python
file = "rename_new.txt"
new_file = file.replace("_new.txt",".txt")
new_file
```




    'rename.txt'




```python
import os
```


```python
os.rename(file,new_file)
```


```python
os.listdir()
```




    ['py_file.ipynb',
     'read.txt',
     'README.md',
     'read_block.txt',
     'read_block_mod.txt',
     'read_block_original.txt',
     'rename.txt',
     'temp.txt',
     'write.txt']




```python
os.getcwd()
```




    'd:\\CSE\\Others\\Codes\\Py\\10Exceptions&&IO\\file'



## Examples

### Rename Files having same name in different directories

```
|--folderA
| |--file.pdf
|--folderB
| |--file.pdf
|--folderC
| |--file.pdf
....
```

to be renamed as:

```
|--folderA
| |--folderA-file.pdf
|--folderB
| |--folderB-file.pdf
|--folderC
| |--folderC-file.pdf
....
```


```python
import os
from turtle import bgcolor
class bcolors:
    HEADER = '\033[95m'
    OKBLUE = '\033[94m'
    OKCYAN = '\033[96m'
    OKGREEN = '\033[92m'
    WARNING = '\033[93m'
    FAIL = '\033[91m'
    ENDC = '\033[0m'
    BOLD = '\033[1m'
    UNDERLINE = '\033[4m'

# import sys
# try:
#     directory_name=sys.argv[1:]
#     print(directory_name)
# except:
#     print('Please pass directory_name')
import argparse
parser = argparse.ArgumentParser()
parser.add_argument("-e","--ext", help="Provide extention name i.e. text,pdf") 	# naming it "path"
args = parser.parse_args()
extension_name=None
if not args.ext:
    parser.error('--ext, -e is required. For help -h')
extension_name="."+str(args.ext)
curr_dir_path = os.getcwd()

for root, subdirs, files in os.walk(curr_dir_path):
    for current_file in files:
        if(current_file.endswith(extension_name)):
            current_folder =  root.split("\\")[-1]
            current_file_path = os.path.join(root,current_file)
            new_name = current_folder.lower()+"-"+current_file
            new_name_path = os.path.join(root,new_name)
            os.rename(current_file_path, new_name_path)
            print(bcolors.OKGREEN+f"Renamed: {current_file} ----> {new_name}"+bcolors.ENDC)
```

command:

```
python main.py --ext=pdf
```
